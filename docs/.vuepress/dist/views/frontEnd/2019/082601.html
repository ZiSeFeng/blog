<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>web安全 | 潇潇风雨</title>
    <meta name="description" content="前端进阶">
    <link rel="icon" href="/blog/favicon.ico">
  <link rel="manifest" href="/blog/manifest.json">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/blog/assets/css/0.styles.2d56dd03.css" as="style"><link rel="preload" href="/blog/assets/js/app.543d1d86.js" as="script"><link rel="preload" href="/blog/assets/js/4.4a4ae430.js" as="script"><link rel="preload" href="/blog/assets/js/1.8473d85e.js" as="script"><link rel="preload" href="/blog/assets/js/32.d029cca0.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.dd05c9ae.js"><link rel="prefetch" href="/blog/assets/js/11.704daa2d.js"><link rel="prefetch" href="/blog/assets/js/12.7967cc54.js"><link rel="prefetch" href="/blog/assets/js/13.58ec5d38.js"><link rel="prefetch" href="/blog/assets/js/14.15b9291f.js"><link rel="prefetch" href="/blog/assets/js/15.c77358df.js"><link rel="prefetch" href="/blog/assets/js/16.38a2cba5.js"><link rel="prefetch" href="/blog/assets/js/17.73f1995f.js"><link rel="prefetch" href="/blog/assets/js/18.67c1ce43.js"><link rel="prefetch" href="/blog/assets/js/19.fd5ec747.js"><link rel="prefetch" href="/blog/assets/js/20.799c2c0d.js"><link rel="prefetch" href="/blog/assets/js/21.3d0be58a.js"><link rel="prefetch" href="/blog/assets/js/22.9a32260f.js"><link rel="prefetch" href="/blog/assets/js/23.c1bb34bb.js"><link rel="prefetch" href="/blog/assets/js/24.b6f48206.js"><link rel="prefetch" href="/blog/assets/js/25.a9c8af90.js"><link rel="prefetch" href="/blog/assets/js/26.d6b4b4de.js"><link rel="prefetch" href="/blog/assets/js/27.81e1a0c5.js"><link rel="prefetch" href="/blog/assets/js/28.723cb083.js"><link rel="prefetch" href="/blog/assets/js/29.8d6a70a1.js"><link rel="prefetch" href="/blog/assets/js/30.5e3378bd.js"><link rel="prefetch" href="/blog/assets/js/31.253f3a2c.js"><link rel="prefetch" href="/blog/assets/js/33.436d4951.js"><link rel="prefetch" href="/blog/assets/js/34.8e2ef724.js"><link rel="prefetch" href="/blog/assets/js/35.4d05ddf0.js"><link rel="prefetch" href="/blog/assets/js/36.f8d72183.js"><link rel="prefetch" href="/blog/assets/js/5.652e39a8.js"><link rel="prefetch" href="/blog/assets/js/6.f1706e65.js"><link rel="prefetch" href="/blog/assets/js/7.c478878f.js"><link rel="prefetch" href="/blog/assets/js/8.0df47dbb.js"><link rel="prefetch" href="/blog/assets/js/9.52d61668.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.17919d1c.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.2d56dd03.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container no-sidebar"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/head.png" alt="潇潇风雨" class="logo"> <span class="site-name">潇潇风雨</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/category/backEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  backEnd
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/frontEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  frontEnd
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/git.html" class="nav-link"><i class="iconfont undefined"></i>
  git
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/计算机基础.html" class="nav-link"><i class="iconfont undefined"></i>
  计算机基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/安全.html" class="nav-link"><i class="iconfont undefined"></i>
  安全
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/notes/frontEnd/" class="nav-link"><i class="iconfont reco-suggestion"></i>
  笔记
</a></div><div class="nav-item"><a href="/blog/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~zisefeng" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-npm"></i>
  NPM
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ZiSeFeng" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/ba26da82e3cd" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/maggie_live" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-csdn"></i>
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/fengyu_5d5fab349a586/articles" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-sf"></i>
  segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/n3c9QN0KJhgzuqCNT0EfrA" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-wechat"></i>
  WeChat
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/category/backEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  backEnd
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/frontEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  frontEnd
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/git.html" class="nav-link"><i class="iconfont undefined"></i>
  git
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/计算机基础.html" class="nav-link"><i class="iconfont undefined"></i>
  计算机基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/category/安全.html" class="nav-link"><i class="iconfont undefined"></i>
  安全
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/notes/frontEnd/" class="nav-link"><i class="iconfont reco-suggestion"></i>
  笔记
</a></div><div class="nav-item"><a href="/blog/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~zisefeng" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-npm"></i>
  NPM
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ZiSeFeng" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/ba26da82e3cd" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/maggie_live" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-csdn"></i>
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/fengyu_5d5fab349a586/articles" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-sf"></i>
  segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/n3c9QN0KJhgzuqCNT0EfrA" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-wechat"></i>
  WeChat
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <!----> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>web安全</h1> <hr> <div data-v-8f042278><i class="iconfont reco-account" data-v-8f042278><span data-v-8f042278>maggie</span></i> <i class="iconfont reco-date" data-v-8f042278><span data-v-8f042278>2019-8-26</span></i> <span id="/blog/views/frontEnd/2019/082601.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-543f3870 data-v-8f042278><i class="iconfont reco-eye" style="margin-right: .5rem" data-v-543f3870></i> <a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;" data-v-543f3870></a></span> <i class="iconfont reco-tag tags" data-v-8f042278><span class="tag-item" data-v-8f042278>
      前端安全
    </span></i></div></div> <div class="content__default"><h2 id="_1-xss跨站脚本攻击"><a href="#_1-xss跨站脚本攻击" aria-hidden="true" class="header-anchor">#</a> 1.XSS跨站脚本攻击</h2> <p>跨站脚本攻击，英文全称（Cross Site Script）,原本缩写是CSS，但是为了和层叠样式表有所去表，所以在安全领域成为“XSS”
XSS攻击，通常指黑客通过“HTML注入”篡改了网页，插入了恶意的脚本，从而在用户浏览网页时，控制用户浏览器的一种攻击。</p> <h3 id="_1-1-有几种xss？"><a href="#_1-1-有几种xss？" aria-hidden="true" class="header-anchor">#</a> 1-1.有几种XSS？</h3> <p>XSS根据效果的不同可以分为反射型、存储型、DOM型三种；</p> <p><strong>反射型XSS</strong>
反射型XSS只是简单把用户输入的数据“反射”给浏览器，换句话说，黑客往往需要诱使用户“点击 ”一个恶意链接，才能攻击成功。反射型XSS，也叫做“非持久型XSS”</p> <p><strong>存储型XSS</strong>
存储型XSS会把用户输入的数据“存储”早服务器。这种XSS具有很强的稳定性。
常见场景：
黑客写下一遍包含有恶意JavaScript代码的博客文章，文章发表后，所有访问该博客文章的用户，都会在他们的浏览器中执行这段恶意的JavaScript代码。黑客把恶意的脚本保存在服务器端。
存储型XSS，也称之为“持久型XSS，因为从效果上看时间是比较长的</p> <p><strong>DOM Based XSS</strong>
实际上，这种类型的XSS并非按照”数据是否保存在服务器端“来访问，DOM Based XSS从效果上来说也是反射型XSS。出于历史原因，也就把它单利作为一个分类。
通过修改页面的DOM节点行程XSS，称之为DOM Based XSS。</p> <h3 id="_1-2-xss的防御"><a href="#_1-2-xss的防御" aria-hidden="true" class="header-anchor">#</a> 1-2.XSS的防御</h3> <p><strong>输入过滤</strong>
对于明确输入类型，例如睡、URL、电话号码、邮件地址等等内容，进行输入过滤还是必要的。既然输入过滤并非完全可靠，我们就要通过”防止浏览器执行恶意代码“来防范XSS。</p> <ul><li>防止HTML出现诸如</li> <li>防止JavaScript执行时，执行恶意代码</li></ul> <p><strong>预防存储型和放射型XSS攻击</strong>
存储型和反射型XSS都是在服务端去除恶意代码后，插入到响应HTML里的，攻击者刻意编写的”数据被内嵌到“代码中，被浏览器所执行。</p> <p>预防措施：</p> <ul><li>改成纯前端渲染，把代码和数据分隔开</li> <li>对HTML做充分转义</li></ul> <p><strong>预防DOM型XSS攻击</strong>
DOM型XSS攻击，实际上就是网站前端JavaScript代码本身不够严谨，把不可信的数据当作代码执行了。
在使用 <code>.innerHTML</code>、<code>.outerHTML</code>、<code>document.write()</code> 时要特别小心，不要把不可信的数据作为 HTML 插到页面上，而应尽量使用 <code>.textContent</code>、<code>.setAttribute()</code> 等。
DOM 中的内联事件监听器，如 <code>location、onclick、onerror、onload、onmouseover</code> 等，<code>&lt;a&gt;</code> 标签的 href 属性，JavaScript 的 <code>eval()、setTimeout()、setInterval()</code> 等，都能把字符串作为代码运行。如果不可信的数据拼接到字符串中传递给这些 API，很容易产生安全隐患，请务必避免。</p> <h3 id="_1-3-其他xss防范措施"><a href="#_1-3-其他xss防范措施" aria-hidden="true" class="header-anchor">#</a> 1-3.其他XSS防范措施**</h3> <p><strong>严格的CSP在XSS的防范中可以起到以下的作用：</strong></p> <ul><li>禁止加载外域代码，防止复杂的攻击逻辑</li> <li>禁止外域提交，网站被攻击后，用户的数据不会泄露到外域</li> <li>禁止内联脚本执行（规则较严格，目前发现github使用）</li> <li>禁止未授权的脚本执行（新特性，Google Map 移动版在使用</li> <li>合理使用上报可以及时发现XSS，利于尽快修复问题</li></ul> <p><strong>输入内容长度的控制</strong><br>
对于不受信任的输入，都应该限定一个合理的长度。虽然无法完全防止XSS攻击，单可以增加XSS攻击的难度</p> <p><strong>其他安全措施</strong></p> <ul><li>HTTP-only Cookie: 禁止JavaScript读取某些敏感Cookie，攻击者完成XSS注入后也无法窃取此Cookie；</li> <li>验证码：防止脚本冒充用户提交危险操作；</li></ul> <h2 id="_2-csrf跨站点请求伪造"><a href="#_2-csrf跨站点请求伪造" aria-hidden="true" class="header-anchor">#</a> 2.CSRF跨站点请求伪造</h2> <p>CSRF（Cross Site Request Forgery）——跨站点请求伪造：攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。</p> <h3 id="_2-1-csrf攻击流程"><a href="#_2-1-csrf攻击流程" aria-hidden="true" class="header-anchor">#</a> 2-1.CSRF攻击流程</h3> <p>一个典型的CSRF攻击有着如下的流程：</p> <ul><li>受害者登录 a.com，并保留了登录凭证（Cookie）</li> <li>攻击者引诱受害者访问了b.com</li> <li>b.com 向 a.com 发送了一个请求：a.com/act=xx浏览器会默认携带a.com的Cookie</li> <li>a.com接收到请求后，对请求进行验证，并确认是受害者的凭证，误以为是受害者自己发送的请求</li> <li>a.com以受害者的名义执行了act=xx</li> <li>攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让a.com执行了自己定义的操作</li></ul> <h3 id="_2-2-csrf的攻击类型"><a href="#_2-2-csrf的攻击类型" aria-hidden="true" class="header-anchor">#</a> 2-2.CSRF的攻击类型</h3> <p><strong>GET类型CSRF</strong>
用户可以尝试构造一个GET请求</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>host<span class="token operator">/</span>register<span class="token operator">?</span>username<span class="token operator">=</span>test<span class="token operator">&amp;</span>password<span class="token operator">=</span>passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>POST类型CSRF</strong>
自动提交表单</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>form action<span class="token string">&quot;/register&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;register&quot;</span> method<span class="token operator">=</span><span class="token string">&quot;post&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;username&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;password&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;password&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>document<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>链接类型的CSRF</strong>
需要用户点击链接才会触发。这种类型通常是在论坛中发布的图片中嵌入恶意链接，或者以广告的形式诱导用户。</p> <h3 id="_2-3-如何防御csrf？"><a href="#_2-3-如何防御csrf？" aria-hidden="true" class="header-anchor">#</a> 2-3.如何防御CSRF？</h3> <p>CSRF通常从第三方网站发起，被攻击的网站无法防止攻击发生，只能通过增强自己网站针对CSRF的防护能力来提升安全性</p> <p>防御措施：</p> <ul><li>验证码</li> <li>referer check用以检查请求是否合法的”源“</li> <li>anti CSRF Token</li></ul> <h2 id="_3-点击劫持（clickjackig）"><a href="#_3-点击劫持（clickjackig）" aria-hidden="true" class="header-anchor">#</a> 3.点击劫持（clickJackig）</h2> <p>点击劫持是一种视觉上的欺骗手段。攻击者使用一个透明的、不可见的iframe，覆盖在一个网页上，然后诱使用户在该网页上进行操作，此时用户将不知情的情况下点击透明的iframe页面。</p> <h3 id="_3-1-防御clickjacking"><a href="#_3-1-防御clickjacking" aria-hidden="true" class="header-anchor">#</a> 3-1.防御clickjacking</h3> <p><strong>frame busting</strong>
禁止iframe的嵌套</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>top<span class="token punctuation">.</span>location <span class="token operator">!=</span> location<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  top<span class="token punctuation">.</span>location <span class="token operator">=</span> self<span class="token punctuation">.</span>location<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>常见的frame busting有一下集中方式</p> <blockquote><p>if (top != self) <br>
if (top.location != self.location) <br>
if (top.location != location) <br>
if (parent.frame.length &gt; 0) <br>
if (window != top) <br>
if (window.top !== window.self) <br>
if (parent &amp;&amp; parent != window) <br>
if (parent &amp;&amp; parent.frame &amp;&amp; parent.frames.length &gt; 0) <br>
top.location = self.location <br>
top.locathon.href = document.location.href <br>
top.location.href = self.location.href <br>
top.location.replace(self.location) <br>
top.location.href = window.location.href <br>
top.location.replace(document.location) <br>
top.location.href = window.location.href <br>
top.location.href = 'URL' <br>
docuement.write('') <br>
top.location = location <br></p></blockquote> <p><strong>X-Frame-Option</strong>
使用一个HTTP头——X-Frame-Option</p> <ul><li>DENY 浏览器会拒绝当前页面加载任何frame页面；</li> <li>SAMEORIGIN frame页面的地址只能为同源域名下的页面</li> <li>ALLOW-FROM origin 允许frame加载的页面地址</li></ul> <h2 id="_4-html5安全"><a href="#_4-html5安全" aria-hidden="true" class="header-anchor">#</a> 4.HTML5安全</h2> <p>HTML5中新增的一些标签和属性，使得XSS等Web攻击产生了新的变化。</p> <h3 id="_4-1-iframe的sanbox"><a href="#_4-1-iframe的sanbox" aria-hidden="true" class="header-anchor">#</a> 4-1.iframe的sanbox</h3> <p>iframe的sanbox属性，限制firame标签加载的内容。</p> <ul><li>allow-same-origin 允许同源访问</li> <li>allow-top-navigation 允许访问顶层窗口</li> <li>allow-forms 允许提交表单</li> <li>allow-scripts 允许执行脚本</li></ul> <h3 id="_4-2-link-type-的noreferer"><a href="#_4-2-link-type-的noreferer" aria-hidden="true" class="header-anchor">#</a> 4-2.link type 的noreferer</h3> <p>在HTML5中a标签和area标签定义了一个新的link type：noreferer。标签指定了noreferer后，浏览器在请求该标签指定的地址时将不再发送referer。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;xxx&quot;</span> rel<span class="token operator">=</span><span class="token string">&quot;noreferer&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-3-canvas"><a href="#_4-3-canvas" aria-hidden="true" class="header-anchor">#</a> 4-3.canvas</h3> <p>canvas标签让JavaScript可以在页面中直接操作图片对象，也可以直接操作像素，构造出图片区域。canvas提供强大的功能，甚至可以用来破解验证码</p> <h3 id="_4-4-其他安全问题"><a href="#_4-4-其他安全问题" aria-hidden="true" class="header-anchor">#</a> 4-4.其他安全问题</h3> <p><strong>Cross-Origin Resource Sharing</strong>
浏览器实现的同源策略（Same Origin Policy）限制了脚本的跨域请求。</p> <blockquote><p>Access-Control-Allow-Origin HTTP Response Header <br>
Access-Control-Max-Age HTTP Response Header<br>
Access-Control-Allow-Credentials HTTP Response Header<br></p></blockquote> <p><strong>postMessage——跨窗口传递消息</strong>
postMessage允许每一个window（包括当前窗口、弹出窗口、iframe等）对象往其他窗口发送文本消息，从而实现跨窗口的消息传递。这个功能是不受同源策略限制的。
使用postMessage时，有两个安全问题需要注意</p> <ul><li>在必要时，可以在接受窗口验证Domain，甚至验证URL，以防止来自非法页面的消息。这实际上是在代码中实现一次同源策略的验证过程</li> <li>在接受消息写入textContent，但是在实际应用中，如果将消息写入innerHTML，甚至直接写入script中，则可能会导致DOM Based XSS的产生。更加”Secure By Default“原则，在接受窗口不应该信任接收到的消息，而需要对消息进行安全检查</li></ul> <p><strong>Web Storage</strong></p> <ul><li>Session Storage</li> <li>Local Storage</li> <li>Cookie
session storage关闭浏览器就会失效，local storage则一直存在。Web Storage就像一个非关系型数据库，由Key-Value对组成，可以通过JavaScript进行操作。</li></ul> <h2 id="_5-注入攻击"><a href="#_5-注入攻击" aria-hidden="true" class="header-anchor">#</a> 5.注入攻击</h2> <p>注入攻击的本质，是把用户输入的数据当做代码执行。
两个关键条件</p> <ul><li>用户能够控制输入</li> <li>原本程序要执行的代码，拼接了用户输入的数据</li></ul> <h3 id="_5-1-sql注入"><a href="#_5-1-sql注入" aria-hidden="true" class="header-anchor">#</a> 5-1.SQL注入</h3> <p>在SQL注入的过程中，如果网站web服务器开启了错误回显，则会为攻击者提供极大的便利，比如攻击者在参数中输入一个单引号”'“，引号执行查询语句的语法错误，服务器直接返回错误信息。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Microsoft Database Engine 错误 <span class="token string">'80040e14'</span>
字符串的语法错误 在查询表达式<span class="token string">'ID=49'</span>中，
<span class="token operator">/</span>showdetail<span class="token punctuation">.</span>asp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>从错误信息中可以知道，服务器用的是Access作为数据库，查询语句的伪代码极有可能是</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>select xxx <span class="token keyword">from</span> table_x where_id <span class="token operator">=</span> $id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_5-2-盲注（blind-injection）"><a href="#_5-2-盲注（blind-injection）" aria-hidden="true" class="header-anchor">#</a> 5-2.盲注（blind injection）</h3> <p>所谓的”盲注“，就是在服务器没有错误回显时完成的注入攻击。服务器没有错误回显，对于攻击者来说缺少了非常重要的”调试信息“，所以攻击者必须找到一个方法验证注入的SQL语句是否得到执行。</p> <h2 id="_6加密算法与随机数"><a href="#_6加密算法与随机数" aria-hidden="true" class="header-anchor">#</a> 6加密算法与随机数</h2> <p>常见的加密算法通常分为分组加密算法与流密码加密算法两种。
<strong>分组加密算法</strong>
分组加密算法基于：分组进行操作，根据算法的不同，每个分组的长度可能不同。
分组加密算法代表DES、3-DES、Blowfish、IDEA、AES等。</p> <p><strong>流密码加密算法</strong>
流密码加密算法：则每次只处理一个字节，密钥独立于消息之外，两者通过异或实现加密与解密。
流密码加密算法的代表有RC4、ORYX、SEAL等。</p></div> <!----> <footer class="page-edit"><!----> <!----></footer> <!----> </main> <div class="valine-wrapper" data-v-3d4d99c6><div id="valine" data-v-3d4d99c6></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-4fd99a39 data-v-4fd99a39><i class="iconfont reco-up" data-v-4fd99a39></i></div></div></div></div><div class="global-ui"><SWUpdatePopup></SWUpdatePopup></div></div>
    <script src="/blog/assets/js/app.543d1d86.js" defer></script><script src="/blog/assets/js/4.4a4ae430.js" defer></script><script src="/blog/assets/js/1.8473d85e.js" defer></script><script src="/blog/assets/js/32.d029cca0.js" defer></script>
  </body>
</html>
